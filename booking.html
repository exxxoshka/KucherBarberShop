<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–ø–∏—Å—å –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É | –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 60px 0;
            border-radius: 0 0 30px 30px;
            margin-bottom: 40px;
        }
        
        .booking-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .service-card {
            border: 2px solid #e9ecef;
            border-radius: 15px;
            transition: all 0.3s;
            cursor: pointer;
            height: 100%;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 20px rgba(106, 17, 203, 0.1);
        }
        
        .service-card.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.05), rgba(37, 117, 252, 0.05));
        }
        
        .time-slot {
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 10px;
        }
        
        .time-slot:hover {
            border-color: var(--primary);
            background: rgba(106, 17, 203, 0.05);
        }
        
        .time-slot.selected {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(106, 17, 203, 0.3);
        }
        
        .confirmation-box {
            background: linear-gradient(135deg, #20c997, #28a745);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 40px;
            position: relative;
        }
        
        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
        }
        
        .step.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .step.completed {
            background: #20c997;
            color: white;
        }
        
        .step-line {
            position: absolute;
            top: 20px;
            left: 60px;
            right: 60px;
            height: 2px;
            background: #e9ecef;
            z-index: 1;
        }
        
        @media (max-width: 768px) {
            .hero-section {
                padding: 40px 0;
            }
            
            .booking-card {
                padding: 20px;
            }
            
            .step-indicator {
                gap: 30px;
            }
            
            .step {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="booking.html" style="color: var(--primary);">
                <span>üíà</span> BarberShop Kucher
            </a>
           
        </div>
    </nav>

    <!-- –ì–µ—Ä–æ–π-—Å–µ–∫—Ü–∏—è -->
    <section class="hero-section">
        <div class="container text-center">
            <h1 class="display-5 fw-bold mb-3">–ó–∞–ø–∏—Å—å –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É</h1>
            <p class="lead mb-0">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É, —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –∏ –∑–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω</p>
        </div>
    </section>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="container">
        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —à–∞–≥–æ–≤ -->
        <div class="step-indicator">
            <div class="step active" id="step1">1</div>
            <div class="step" id="step2">2</div>
            <div class="step" id="step3">3</div>
            <div class="step" id="step4">4</div>
            <div class="step-line"></div>
        </div>

        <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ -->
        <div class="booking-card" id="step1Content">
            <h3 class="mb-4">1. –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</h3>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="service-card" data-service="–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞" data-price="1500">
                        <div class="card-body text-center">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üë®</div>
                            <h5>–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞</h5>
                            <p class="text-muted">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–ª–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Ç—Ä–∏–∂–∫–∞</p>
                            <div class="fw-bold text-primary fs-4">1 500 ‚ÇΩ</div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="service-card" data-service="–ë—Ä–∏—Ç—å–µ" data-price="1000">
                        <div class="card-body text-center">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">‚úÇÔ∏è</div>
                            <h5>–ë—Ä–∏—Ç—å–µ</h5>
                            <p class="text-muted">–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –±—Ä–∏—Ç—å–µ —Å —É—Ö–æ–¥–æ–º</p>
                            <div class="fw-bold text-primary fs-4">1 000 ‚ÇΩ</div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="service-card" data-service="–ö–æ–º–ø–ª–µ–∫—Å" data-price="2200">
                        <div class="card-body text-center">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üëë</div>
                            <h5>–ö–æ–º–ø–ª–µ–∫—Å</h5>
                            <p class="text-muted">–°—Ç—Ä–∏–∂–∫–∞ + –±—Ä–∏—Ç—å–µ + —É–∫–ª–∞–¥–∫–∞</p>
                            <div class="fw-bold text-primary fs-4">2 200 ‚ÇΩ</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <button class="btn btn-primary btn-lg" onclick="nextStep(1)">
    –î–∞–ª–µ–µ ‚Üí –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏
</button>
            </div>
        </div>

        <!-- –®–∞–≥ 2: –í—ã–±–æ—Ä –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ -->
        <div class="booking-card" id="step2Content" style="display: none;">
            <h3 class="mb-4">2. –í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è</h3>
            
            <div class="row">
                <div class="col-md-6 mb-4">
                    <label class="form-label fw-bold">–î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏</label>
                    <input type="date" id="bookingDate" class="form-control form-control-lg">
                </div>
                
                <div class="col-md-6">
                    <div class="alert alert-primary">
                        <strong>–í—ã–±—Ä–∞–Ω–æ:</strong>
                        <div id="selectedServiceInfo">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</div>
                        <div id="selectedPriceInfo" class="fw-bold fs-5 mt-1"></div>
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="form-label fw-bold">–í—Ä–µ–º—è –∑–∞–ø–∏—Å–∏</label>
                <div class="row g-2" id="timeSlots">
                    <!-- –í—Ä–µ–º—è –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="d-flex justify-content-between">
                <button class="btn btn-outline-secondary" onclick="nextStep(0)"> <!-- –º–µ–Ω—è–µ–º –Ω–∞ 0 -->
    ‚Üê –ù–∞–∑–∞–¥
</button>
<button class="btn btn-primary" onclick="nextStep(2)" id="nextToStep3" disabled>
    –î–∞–ª–µ–µ ‚Üí –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
</button>
            </div>
        </div>

        <!-- –®–∞–≥ 3: –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="booking-card" id="step3Content" style="display: none;">
            <h3 class="mb-4">3. –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h3>
            
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">–§–ò–û *</label>
                    <input type="text" id="clientName" class="form-control" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" required>
                </div>
                
                <div class="col-md-6">
                    <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" id="clientPhone" class="form-control" placeholder="+7 (999) 123-45-67" required>
                </div>
                
                <div class="col-12">
                    <label class="form-label">Email (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="email" id="clientEmail" class="form-control" placeholder="example@mail.ru">
                </div>
                
                <div class="col-12">
                    <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea id="clientComment" class="form-control" rows="3" placeholder="–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è..."></textarea>
                </div>
            </div>
            
            <div class="confirmation-box" id="bookingSummary" style="display: none;">
                <h5>üìã –í–∞—à–∞ –∑–∞–ø–∏—Å—å</h5>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>–£—Å–ª—É–≥–∞:</strong> <span id="summaryService"></span></p>
                        <p><strong>–î–∞—Ç–∞:</strong> <span id="summaryDate"></span></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>–í—Ä–µ–º—è:</strong> <span id="summaryTime"></span></p>
                        <p><strong>–¶–µ–Ω–∞:</strong> <span id="summaryPrice"></span></p>
                    </div>
                </div>
            </div>
            
            <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-outline-secondary" onclick="nextStep(1)"> <!-- –º–µ–Ω—è–µ–º –Ω–∞ 1 -->
    ‚Üê –ù–∞–∑–∞–¥
</button>

                <button class="btn btn-primary" onclick="submitBooking()" id="submitBtn">
                    ‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                </button>
            </div>
        </div>

        <!-- –®–∞–≥ 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
        <div class="booking-card text-center" id="step4Content" style="display: none;">
            <div style="font-size: 4rem; color: #28a745; margin-bottom: 1rem;">‚úÖ</div>
            <h3 class="mb-3">–ó–∞–ø–∏—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!</h3>
            <p class="lead mb-4">–ú—ã –∂–¥—ë–º –≤–∞—Å –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.</p>
            
            <div class="card border-success mx-auto" style="max-width: 500px;">
                <div class="card-body text-start">
                    <h5 class="card-title">–î–µ—Ç–∞–ª–∏ –∑–∞–ø–∏—Å–∏</h5>
                    <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> <span id="confirmName"></span></p>
                    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="confirmPhone"></span></p>
                    <p><strong>–£—Å–ª—É–≥–∞:</strong> <span id="confirmService"></span></p>
                    <p><strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong> <span id="confirmDateTime"></span></p>
                    <p><strong>–¶–µ–Ω–∞:</strong> <span id="confirmPrice"></span></p>
                    <p><strong>–ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏:</strong> <span id="confirmId" class="badge bg-primary"></span></p>
                </div>
            </div>
            
            <div class="alert alert-info mt-4">
                <strong>üì± –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏!</strong> –û–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è —Å–≤—è–∑–∏.
            </div>
            
            <div class="mt-4">
                <button class="btn btn-primary" onclick="newBooking()">
                    üÜï –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å
                </button>
            </div>
        </div>
    </div>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>üíà BarberShop</h5>
                    <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∏–∂–∫–∏ –∏ –±—Ä–∏—Ç—å–µ</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>üìû +7 (999) 123-45-67</p>
                    <p>üìç —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 123</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ===== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE =====
        const firebaseConfig = {
            apiKey: "AIzaSyDwXOEGv2GBkeWggfhcBnfKQWnHDVeI890",
            authDomain: "barber-salon-cucher.firebaseapp.com",
            projectId: "barber-salon-cucher",
            storageBucket: "barber-salon-cucher.firebasestorage.app",
            messagingSenderId: "337468108878",
            appId: "1:337468108878:web:0fbcb5f537d891cd2ed31f"
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // ===== –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let bookingData = {
            service: null,
            price: null,
            date: null,
            time: null,
            id: null
        };
        
        const timeSlots = ['10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00'];
        
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            
            // –£—Å—Ç–∞–Ω–æ–≤–∏–º –¥–∞—Ç—É (–∑–∞–≤—Ç—Ä–∞)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('bookingDate').value = tomorrow.toISOString().split('T')[0];
            bookingData.date = tomorrow.toISOString().split('T')[0];
            
            // –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.service-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    
                    bookingData.service = this.dataset.service;
                    bookingData.price = this.dataset.price;
                    
                    console.log('–í—ã–±—Ä–∞–Ω–∞ —É—Å–ª—É–≥–∞:', bookingData.service, bookingData.price);
                });
            });
            
            // –ú–∞—Å–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            document.getElementById('clientPhone').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 1) {
                    value = '+7 (' + value.substring(1, 4) + ') ' + 
                            value.substring(4, 7) + '-' + 
                            value.substring(7, 9) + '-' + 
                            value.substring(9, 11);
                }
                e.target.value = value.substring(0, 18);
            });
            
            // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞—Ç—ã
            document.getElementById('bookingDate').addEventListener('change', function() {
                bookingData.date = this.value;
                generateTimeSlots();
                updateSummary();
            });
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Ä–µ–º—è
            generateTimeSlots();
        });
        
        // ===== –§–£–ù–ö–¶–ò–ò –®–ê–ì–û–í =====
        window.nextStep = function(currentStep) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∏
    if (currentStep === 1 && !bookingData.service) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É!');
        return;
    }
    
    if (currentStep === 2 && !bookingData.time) {
        alert('–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è!');
        return;
    }
    
    // –°–∫—Ä—ã—Ç—å –≤—Å–µ —à–∞–≥–∏
    for (let i = 1; i <= 4; i++) {
        const stepEl = document.getElementById(`step${i}Content`);
        if (stepEl) {
            stepEl.style.display = 'none';
        }
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
    const nextStepNum = currentStep + 1;
    const nextEl = document.getElementById(`step${nextStepNum}Content`);
    if (nextEl) {
        nextEl.style.display = 'block';
    }
    
    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    for (let i = 1; i <= 4; i++) {
        const indicator = document.getElementById(`step${i}`);
        if (indicator) {
            indicator.classList.remove('active', 'completed');
            if (i < nextStepNum) {
                indicator.classList.add('completed');
            } else if (i === nextStepNum) {
                indicator.classList.add('active');
            }
        }
    }
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
    if (nextStepNum === 2) {
        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ª—É–≥–µ
        const serviceInfo = document.getElementById('selectedServiceInfo');
        const priceInfo = document.getElementById('selectedPriceInfo');
        if (serviceInfo && priceInfo) {
            serviceInfo.textContent = bookingData.service || '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            priceInfo.textContent = bookingData.price ? bookingData.price + ' ‚ÇΩ' : '';
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å–ª–æ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
        generateTimeSlots();
    }
    
    if (nextStepNum === 3) {
        updateSummary();
    }
};
        
        function prevStep(currentStep) {
            const prevStep = currentStep - 1;
            
            document.querySelectorAll('[id$="Content"]').forEach(el => {
                el.style.display = 'none';
            });
            
            document.getElementById(`step${prevStep}Content`).style.display = 'block';
            updateStepIndicator(prevStep);
        }
        
        function updateStepIndicator(step) {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏
            document.querySelectorAll('.step').forEach(el => {
                el.classList.remove('active', 'completed');
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ/–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
            for (let i = 1; i <= 4; i++) {
                const stepEl = document.getElementById(`step${i}`);
                if (i < step) {
                    stepEl.classList.add('completed');
                } else if (i === step) {
                    stepEl.classList.add('active');
                }
            }
        }
        
        // ===== –í–†–ï–ú–ï–ù–ù–´–ï –°–õ–û–¢–´ =====
        function generateTimeSlots() {
            const container = document.getElementById('timeSlots');
            if (!container) return;
            
            container.innerHTML = '';
            
            // –î–ª—è –¥–µ–º–æ - —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã
            const bookedSlots = [];
            for (let i = 0; i < 3; i++) {
                bookedSlots.push(timeSlots[Math.floor(Math.random() * timeSlots.length)]);
            }
            
            timeSlots.forEach(time => {
                const isBooked = bookedSlots.includes(time);
                const col = document.createElement('div');
                col.className = 'col-6 col-md-4 col-lg-3';
                
                col.innerHTML = `
                    <div class="time-slot ${isBooked ? 'disabled' : ''}" 
                         onclick="${isBooked ? '' : `selectTime('${time}')`}">
                        ${time}
                    </div>
                `;
                
                container.appendChild(col);
            });
        }
        
        function selectTime(time) {
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            document.querySelectorAll('.time-slot').forEach(el => {
                el.classList.remove('selected');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ
            event.target.classList.add('selected');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º
            bookingData.time = time;
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById('nextToStep3').disabled = false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤–æ–¥–∫—É
            updateSummary();
        }
        
        // ===== –ò–ù–§–û–†–ú–ê–¶–ò–Ø =====
        function updateServiceInfo() {
            if (bookingData.service) {
                document.getElementById('selectedServiceInfo').textContent = bookingData.service;
                document.getElementById('selectedPriceInfo').textContent = bookingData.price + ' ‚ÇΩ';
            }
        }
        
        function updateSummary() {
            const summaryEl = document.getElementById('bookingSummary');
            
            if (bookingData.service && bookingData.date && bookingData.time && bookingData.price) {
                summaryEl.style.display = 'block';
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
                const dateObj = new Date(bookingData.date);
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const formattedDate = dateObj.toLocaleDateString('ru-RU', options);
                
                document.getElementById('summaryService').textContent = bookingData.service;
                document.getElementById('summaryDate').textContent = formattedDate;
                document.getElementById('summaryTime').textContent = bookingData.time;
                document.getElementById('summaryPrice').textContent = bookingData.price + ' ‚ÇΩ';
            } else {
                summaryEl.style.display = 'none';
            }
        }
        
        // ===== –û–¢–ü–†–ê–í–ö–ê –ó–ê–ü–ò–°–ò =====
        async function submitBooking() {
            console.log('–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å...');
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const clientName = document.getElementById('clientName').value.trim();
            const clientPhone = document.getElementById('clientPhone').value;
            const clientEmail = document.getElementById('clientEmail').value.trim();
            const comment = document.getElementById('clientComment').value.trim();
            
            // –í–ê–õ–ò–î–ê–¶–ò–Ø
            if (!clientName) {
                alert('–í–≤–µ–¥–∏—Ç–µ –§–ò–û');
                return;
            }
            
            if (!clientPhone || clientPhone.replace(/\D/g, '').length < 11) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω');
                return;
            }
            
            if (!bookingData.service) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É');
                return;
            }
            
            if (!bookingData.date || !bookingData.time) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è');
                return;
            }
            
            // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            const cleanPhone = clientPhone.replace(/\D/g, '');
            
            const appointment = {
                // –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞
                clientName: clientName,
                phone: cleanPhone,
                email: clientEmail,
                
                // –î–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
                service: bookingData.service,
                price: parseInt(bookingData.price),
                appointment_date: bookingData.date,
                appointment_time: bookingData.time,
                
                // –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                type: 'client',
                status: 'pending',
                comment: comment,
                created_at: new Date().toISOString(),
                
                // –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                admin_viewed: false,
                source: 'online_booking'
            };
            
            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å:', appointment);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> –û—Ç–ø—Ä–∞–≤–∫–∞...';
            submitBtn.disabled = true;
            
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
                const docRef = await db.collection('appointments').add(appointment);
                console.log('‚úÖ –ó–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞, ID:', docRef.id);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID
                bookingData.id = docRef.id;
                bookingData.clientName = clientName;
                bookingData.clientPhone = clientPhone;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                showConfirmation();
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —à–∞–≥—É 4
                nextStep(3);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message);
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                submitBtn.innerHTML = '‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è';
                submitBtn.disabled = false;
            }
        }
        
        // ===== –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï =====
        function showConfirmation() {
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
            const dateObj = new Date(bookingData.date);
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = dateObj.toLocaleDateString('ru-RU', options);
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            document.getElementById('confirmName').textContent = bookingData.clientName;
            document.getElementById('confirmPhone').textContent = bookingData.clientPhone;
            document.getElementById('confirmService').textContent = bookingData.service;
            document.getElementById('confirmDateTime').textContent = `${formattedDate} –≤ ${bookingData.time}`;
            document.getElementById('confirmPrice').textContent = bookingData.price + ' ‚ÇΩ';
            document.getElementById('confirmId').textContent = bookingData.id ? bookingData.id.substring(0, 8).toUpperCase() : 'DEMO';
        }
        
        // ===== –ù–û–í–ê–Ø –ó–ê–ü–ò–°–¨ =====
        function newBooking() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            bookingData = {
                service: null,
                price: null,
                date: null,
                time: null,
                id: null
            };
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('clientName').value = '';
            document.getElementById('clientPhone').value = '';
            document.getElementById('clientEmail').value = '';
            document.getElementById('clientComment').value = '';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            document.querySelectorAll('.service-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById('nextToStep3').disabled = true;
            
            // –ù–∞—á–∏–Ω–∞–µ–º —Å —à–∞–≥–∞ 1
            document.querySelectorAll('[id$="Content"]').forEach(el => {
                el.style.display = 'none';
            });
            document.getElementById('step1Content').style.display = 'block';
            updateStepIndicator(1);
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '‚úÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è';
            submitBtn.disabled = false;
        }
    </script>
</body>
</html>